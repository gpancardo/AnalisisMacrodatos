CONSULTAS AVANZADAS CON CUBO (DOS CONSULTAS AVANZADAS, DEBEMOS DE HACER LO MISMO DE CAMBIAR LOS NOMBRES POR LOS NOMBRES DE NUESTRAS TABLAS)


1. Accidentes por estado, año y día de la semana
SELECT
    COALESCE(e.NOM_ENT, 'Zz_TOTAL_ESTADO') AS ESTADO,
    COALESCE(a.ANIO, 'TOTAL_ANIO') AS ANIO,
    COALESCE(a.DIA_SEMANA, 'TOTAL_DIA_SEMANA') AS DIA_SEMANA,
    COUNT(*) AS NR_ACCIDENTES,
    GROUPING_ID(e.NOM_ENT, a.ANIO, a.DIA_SEMANA) AS GRUPO_ID
FROM accidentes a
JOIN entidadesfederativas e ON a.ID_ENTIDAD = e.CVE_ENT
GROUP BY CUBE(e.NOM_ENT, a.ANIO, a.DIA_SEMANA)
ORDER BY ESTADO, ANIO, DIA_SEMANA;


2. Accidentes por tipo de vía, clima y gravedad
SELECT
    COALESCE(TIPOVIA, 'Zz_TOTAL_TIPO_VIA') AS TIPO_VIA,
    COALESCE(CONDICION_CLIMATICA, 'TOTAL_CLIMA') AS CLIMA,
    COALESCE(CLASACC, 'TOTAL_GRAVEDAD') AS GRAVEDAD,
    COUNT(*) AS NR_ACCIDENTES,
    GROUPING_ID(TIPOVIA, CONDICION_CLIMATICA, CLASACC) AS GRUPO_ID
FROM accidentes
GROUP BY CUBE(TIPOVIA, CONDICION_CLIMATICA, CLASACC)
ORDER BY TIPO_VIA, CLIMA, GRAVEDAD;
